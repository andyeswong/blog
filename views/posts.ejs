<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artículos - AWONG_blog</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/styles.css">
</head>
<body class="font-mono overflow-x-hidden" style="background-color: var(--body-bg); color: var(--fg);">
  <!-- Dynamic Island Navbar -->
  <nav class="fixed top-6 left-1/2 transform -translate-x-1/2 z-50">
    <div class="flex items-center justify-center gap-4 px-6 py-3 backdrop-blur-xl rounded-full border transition-all duration-500" style="background-color: rgba(40, 42, 54, 0.6); border-color: var(--border-color);">
      <span class="text-sm font-light tracking-[0.1em]" style="color: var(--cyan)">AWONG_blog</span>
      <div class="w-px h-6" style="background-color: var(--border-color)"></div>
      <div class="flex gap-1">
        <a href="/" class="px-6 py-2 font-light tracking-[0.1em] transition-all duration-300 rounded-full hover:bg-opacity-50" style="color: var(--purple)">inicio</a>
        <a href="/posts" class="px-6 py-2 font-light tracking-[0.1em] transition-all duration-300 rounded-full border" style="background-color: rgba(40, 42, 54, 0.8); border-color: var(--cyan); color: var(--cyan)">artículos</a>
        <a href="/about" class="px-6 py-2 font-light tracking-[0.1em] transition-all duration-300 rounded-full hover:bg-opacity-50" style="color: var(--purple)">acerca</a>
      </div>
      <div class="w-px h-6" style="background-color: var(--border-color)"></div>
      <button id="theme-toggle" class="theme-toggle" title="Cambiar tema"></button>
    </div>
  </nav>

  <!-- Posts Section -->
  <section class="py-24 px-4 sm:px-8 max-w-6xl mx-auto pt-28">
    <!-- Header -->
    <div class="mb-16">
      <% if (searchQuery) { %>
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-light tracking-tight mb-4" style="color: var(--fg)">
          Resultados: "<%= searchQuery %>"
        </h1>
        <p style="color: var(--comment)">Se encontraron <%= totalPosts %> artículos</p>
      <% } else if (selectedTag) { %>
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-light tracking-tight mb-4" style="color: var(--fg)">
          #<%= selectedTag %>
        </h1>
        <p style="color: var(--comment)"><%= totalPosts %> artículos con esta etiqueta</p>
      <% } else { %>
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-light tracking-tight mb-4" style="color: var(--fg)">
          artículos_recientes
        </h1>
        <p style="color: var(--comment)">Total: <%= totalPosts %> artículos</p>
      <% } %>
      <div class="w-16 h-px mt-4" style="background: linear-gradient(to right, var(--cyan), transparent)"></div>
    </div>

    <!-- Search Bar -->
    <div class="mb-12">
      <form action="/search" method="get" class="flex gap-3">
        <input 
          type="text" 
          name="q" 
          placeholder="Buscar artículos..." 
          class="flex-1 px-4 py-3 bg-[#282a36]/40 border border-purple-500/20 rounded-lg focus:outline-none focus:border-purple-500/50 backdrop-blur-md font-light"
          style="color: var(--fg); caret-color: var(--cyan);"
        />
        <button 
          type="submit" 
          class="px-6 py-3 bg-[#282a36]/40 border border-purple-500/20 rounded-lg hover:border-purple-500/50 transition-all duration-300 backdrop-blur-md font-light"
          style="color: var(--cyan);"
        >
          Buscar
        </button>
      </form>
    </div>

    <!-- Tags Filter -->
    <% if (tags.length > 0) { %>
      <div class="mb-12">
        <p class="mb-4 font-light tracking-tight" style="color: var(--purple)">filtrar por:</p>
        <div class="flex flex-wrap gap-2">
          <% tags.forEach(tag => { %>
            <a 
              href="/posts/tag/<%= tag %>"
              class="px-4 py-2 bg-[#282a36]/40 border border-purple-500/20 rounded-lg hover:border-purple-500/50 hover:bg-[#282a36]/60 transition-all duration-300 font-light text-sm"
              style="color: <%= selectedTag === tag ? 'var(--green)' : 'var(--cyan)' %>; border-color: <%= selectedTag === tag ? 'rgba(80, 250, 123, 0.5)' : 'rgba(139, 233, 253, 0.2)' %>"
            >
              #<%= tag %>
            </a>
          <% }); %>
        </div>
      </div>
    <% } %>

    <!-- Posts Grid -->
    <% if (posts.length > 0) { %>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-1 gap-8 mb-12">
        <% posts.forEach(post => { %>
          <article class="group border border-purple-500/20 p-8 bg-[#282a36]/40 backdrop-blur-md rounded-lg hover:border-purple-500/40 hover:bg-[#282a36]/60 transition-all duration-500">
            <div class="flex flex-col md:flex-row gap-6">
              <!-- Image -->
              <% if (post.image_url) { %>
                <div class="md:w-1/3 flex-shrink-0">
                  <img 
                    src="<%= post.image_url %>" 
                    alt="<%= post.title %>"
                    class="w-full h-40 md:h-48 object-cover rounded-lg opacity-60 group-hover:opacity-80 transition-opacity duration-500"
                  />
                </div>
              <% } %>

              <!-- Content -->
              <div class="flex-1">
                <!-- Tags -->
                <div class="mb-3 flex flex-wrap gap-2">
                  <% post.tags.slice(0, 3).forEach(tag => { %>
                    <a 
                      href="/posts/tag/<%= tag %>"
                      class="text-xs px-2 py-1 bg-purple-500/10 border border-purple-500/30 rounded font-light hover:bg-purple-500/20 transition-colors"
                      style="color: var(--purple)"
                    >
                      #<%= tag %>
                    </a>
                  <% }); %>
                </div>

                <!-- Title -->
                <h2 class="text-2xl font-light mb-3 tracking-tight" style="color: var(--green)">
                  <a href="/posts/<%= post.id %>" class="hover:text-green-300 transition-colors">
                    <%= post.title %>
                  </a>
                </h2>

                <!-- Description -->
                <p class="mb-4 font-light leading-relaxed line-clamp-2" style="color: var(--fg)">
                  <%= post.description %>
                </p>

                <!-- Meta info -->
                <div class="flex flex-wrap gap-6 text-sm font-light" style="color: var(--comment)">
                  <span><%= new Date(post.metadata.created_time).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' }) %></span>
                  <span><%= post.author || 'AWONG' %></span>
                  <% if (post.reading_time) { %>
                    <span><%= post.reading_time %> min de lectura</span>
                  <% } %>
                  <% if (post.views) { %>
                    <span><%= post.views %> vistas</span>
                  <% } %>
                </div>

                <!-- Read More -->
                <div class="mt-4">
                  <a 
                    href="/posts/<%= post.id %>" 
                    class="font-light tracking-[0.1em] hover:text-blue-300 transition-colors"
                    style="color: var(--cyan)"
                  >
                    leer más →
                  </a>
                </div>
              </div>
            </div>
          </article>
        <% }); %>
      </div>

      <!-- Pagination -->
      <% if (totalPages > 1) { %>
        <div class="flex justify-center items-center gap-4 mb-12">
          <% if (currentPage > 1) { %>
            <a 
              href="/posts?page=<%= currentPage - 1 %>"
              class="px-4 py-2 border border-purple-500/20 rounded-lg hover:border-purple-500/50 font-light"
              style="color: var(--cyan)"
            >
              ← anterior
            </a>
          <% } %>

          <div class="flex gap-2">
            <% for (let i = 1; i <= totalPages; i++) { %>
              <a 
                href="/posts?page=<%= i %>"
                class="px-3 py-2 rounded-lg font-light transition-all"
                style="<% if (i === currentPage) { %>background-color: rgba(139, 233, 253, 0.2); border: 1px solid var(--cyan); color: var(--cyan);<% } else { %>border: 1px solid rgba(139, 233, 253, 0.2); color: var(--cyan);<% } %>"
              >
                <%= i %>
              </a>
            <% } %>
          </div>

          <% if (currentPage < totalPages) { %>
            <a 
              href="/posts?page=<%= currentPage + 1 %>"
              class="px-4 py-2 border border-purple-500/20 rounded-lg hover:border-purple-500/50 font-light"
              style="color: var(--cyan)"
            >
              siguiente →
            </a>
          <% } %>
        </div>
      <% } %>
    <% } else { %>
      <!-- No posts found -->
      <div class="text-center py-16">
        <p class="text-xl font-light tracking-tight mb-4" style="color: var(--comment)">
          no se encontraron artículos
        </p>
        <a 
          href="/posts" 
          class="font-light tracking-[0.1em] hover:text-blue-300 transition-colors"
          style="color: var(--cyan)"
        >
          ver todos los artículos →
        </a>
      </div>
    <% } %>
  </section>

  <%- include('footer') %>

  <script src="/theme.js"></script>
  <script src="/glitch.js"></script>
</body>
</html>
